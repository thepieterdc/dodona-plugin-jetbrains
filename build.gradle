plugins {
    id 'de.fuerstenau.buildconfig' version '1.1.8'
    id 'idea'
    id 'jacoco'
    id 'java'
    id 'org.jetbrains.intellij' version '0.4.15'
}

group 'io.github.thepieterdc.dodona'
version '2.0.3-SNAPSHOT'

sourceCompatibility = 1.8

buildConfig {
    packageName 'io.github.thepieterdc.dodona.plugin'
}

repositories {
    mavenCentral()

    maven {
        url "https://dl.bintray.com/thepieterdc/dodona-api-java"
    }

    maven {
        url "https://dl.bintray.com/thepieterdc/random-java"
    }
}

dependencies {
    compile group: 'io.github.thepieterdc.dodona', name: 'dodona-api-interface', version: '1.6.0'
    runtime group: 'io.github.thepieterdc.dodona', name: 'dodona-api-impl', version: '1.6.0'

    compile group: 'com.github.marlonlom', name: 'timeago', version: '4.0.1'

    testCompile group: 'junit', name: 'junit', version: '4.12'
    testCompile group: 'org.mockito', name: 'mockito-core', version: '3.1.0'
    testCompile group: 'io.github.thepieterdc.random', name: 'random', version: '0.3.0'
}

intellij {
    downloadSources false
    pluginName 'dodona'
    plugins = ['java', 'PythonCore:193.5233.139']
    updateSinceUntilBuild false
    version 'IU-193.5662.53'
}

jacocoTestReport {
    dependsOn test

    reports {
        html.enabled = true
        xml.enabled = true
    }
}

patchPluginXml {
    changeNotes """
      [BUGFIX] Enable the OK button if an exercise is auto-selected at the Identification dialog.
      [BUGFIX] Set the class name based on the name of the file when creating new Java exercises. 
      """

    pluginDescription "Companion plugin for the Ghent University Dodona platform, which allows you to submit exercises right from your favourite JetBrains IDE."

    sinceBuild '171.0'
}
