plugins {
    id 'de.fuerstenau.buildconfig' version '1.1.8'
    id 'idea'
    id 'jacoco'
    id 'java'
    id 'org.jetbrains.intellij' version '0.6.3'
}

group 'io.github.thepieterdc.dodona'
version '2.1.1-SNAPSHOT'

sourceCompatibility = 1.8

buildConfig {
    packageName 'io.github.thepieterdc.dodona.plugin'
}

repositories {
    mavenCentral()

    maven {
        url = "https://maven.pkg.github.com/thepieterdc/dodona-api-java"
        credentials {
            username = "PublicToken"
            password = "\u0064\u0064\u0066\u0039\u0036\u0065\u0030\u0063\u0061\u0032\u0066\u0065\u0032\u0039\u0033\u0033\u0036\u0030\u0035\u0062\u0031\u0033\u0031\u0035\u0038\u0063\u0061\u0064\u0061\u0033\u0030\u0031\u0030\u0035\u0062\u0037\u0035\u0032\u0066\u0061"
        }
    }

    maven {
        url "https://dl.bintray.com/thepieterdc/random-java"
    }
}

dependencies {
    compile group: 'io.github.thepieterdc.dodona', name: 'dodona-api-interface', version: '1.9.3'
    runtime group: 'io.github.thepieterdc.dodona', name: 'dodona-api-impl', version: '1.9.3'

    compile group: 'com.github.marlonlom', name: 'timeago', version: '4.0.1'

    testCompile group: 'junit', name: 'junit', version: '4.13.1'
    testCompile group: 'org.mockito', name: 'mockito-core', version: '3.6.0'
    testCompile group: 'io.github.thepieterdc.random', name: 'random', version: '0.3.0'
}

intellij {
    downloadSources false
    pluginName 'dodona'
    plugins = ['java', 'PythonCore:193.5233.102']
    updateSinceUntilBuild false
    version '193.5233.102'
}

jacocoTestReport {
    dependsOn test

    reports {
        html.enabled = true
        xml.enabled = true
    }
}

patchPluginXml {
    changeNotes """
      <ul>
        <li>[BUGFIX] Opening large files will no longer show an error message.</li>
        <li>[INTERNAL] Update dependencies.</li>
      </ul>
      """

    pluginDescription "Companion plugin for the Ghent University Dodona platform, which allows you to submit exercises right from your favourite JetBrains IDE."

    sinceBuild '193.3519.25'
}

wrapper {
    gradleVersion = '6.2.1'
}
